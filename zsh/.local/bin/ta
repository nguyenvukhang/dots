#!/usr/bin/env zsh

# tmux attach script: ta

SESSION_NAME="${1-uni}" # default value: "base"

typeset -A START_DIRLIST=(
  [base]="$HOME"
  [uni]="$HOME/repos/uni"
  [sun]="$HOME/sunnus/app/dev"
)

# results in c containing either $HOME or start dir
s=$START_DIRLIST[$SESSION_NAME]
[ $s ] && START_DIR=$s || START_DIR=$HOME

# check for existence of requested session
! tmux has-session -t "$SESSION_NAME" 2>/dev/null
session_exists=$?

# create it if it doesn't exist
create() { tmux new-session -d -s $SESSION_NAME -c $START_DIR }
[[ $session_exists == 0 ]] && create

function outside() {
  tmux attach -t $SESSION_NAME
}

function inside() {
  tmux switch-client -t $SESSION_NAME
}

# outside of tmux
[ -z "$TMUX" ] && outside || inside
return 0
