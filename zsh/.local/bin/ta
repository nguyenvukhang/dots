#!/bin/zsh

# tmux attach script: ta

t="${1-base}"
# v=false
# first argument is target attach
# default value: "base"

function tmux_new() {
  tmux new-session -d -s $t -n server
}

if [ -z "$TMUX" ]; then # when outside of tmux
  if ! tmux has-session -t "$t" 2>/dev/null; then
    # if session doesn't exist, create it
    tmux_new
  fi
  tmux attach -t $t:server; return
else # when inside of tmux
  if ! tmux has-session -t $t 2>/dev/null; then
    # if target doesn't exist,
    # just start a new session first
    tmux_new
  fi
  tmux switch-client -t $t:server; return
fi
